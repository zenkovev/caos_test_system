# 12-1: Python: Pyprimes

## Условие задачи

Реализуйте Python-модуль primes с функцией factor\_out, которая выполняет разложение целого числа на
простые множители, и возвращает их в виде списка.

В случае, если число уже является простым, то не нужно раскладывать на множители,
а вернуть строку Prime!.

Не забывайте обрабатывать ошибочные ситуации!

Пример использования модуля:

```
Python 3.8.5 (default, Jul 21 2020, 10:48:26)
[Clang 11.0.3 (clang-1103.0.32.62)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> import primes
>>> primes.factor_out(100)
[2, 2, 5, 5]
>>> primes.factor_out(17)
'Prime!'
>>>
```

## Комментарий к тестам

Далее для краткости будем называть числами `int32_t` числа, которые можно представить
этим типом из C/C++, аналогично числа `int64_t`.

Ожидается следующая работа функции `factor_out` в зависимости от входа:
- для положительных чисел `int64_t` по модулю >= 2:
возвращается либо список простых множителей, упорядоченных по возрастанию,
как `List`, содержащий объекты типа `Int`, либо строка **Prime!**
- для отрицательных чисел `int64_t` по модулю >= 2:
возвращаемое значение совпадает с возвращаемым значением
для соответствующего положительного числа
- для чисел 1, -1: вовращается пустой `List`
- для всех остальных чисел: кидается исключение типа `ValueError`
- во всех остальных случаях: кидается исключение типа `TypeError`

При этом тесты `run.sh` проверяют только случай чисел `int32_t` >= 2,
остальное проверяется тестами `run_hard.sh`.

Сборка модуля производится с помощью `cmake`,
для этого в директории с задачей есть `CMakeLists.txt`.
Отчёт о сборке выводится в файл `tmp_files/cmake_and_make_output.txt`.
Если модуль собран успешно, то он находится как `tmp_files/primes.so`.

В этой задаче один из тестов использует входные данные, генерирующиеся рандомно.
Для этого генерируется файл со случайными числами `tmp_files/random_numbers.txt`.
Для удобства тестирования ожидаемый вывод этого теста сохраняется в директории `test_files`,
как `test_files/expected_output/TestSimple2Random.txt`.
Поэтому не совсем верно, что директория `test_files` остаётся неизменной.

## Краткое описание работы тестов

При тестировании создаётся модуль, требуемый в задаче.
Для этого с помощью `CMakeLists.txt` производится сборка в `tmp_files/build`,
после чего собранный модуль выносится как `tmp_files/primes.so`.
(Если модуль не собран, то часть со скриптами, использующими этот модуль, не запускается.)
Туда же, в `tmp_files`, копируется скрипт `help_functions.py` со вспомогательной функцией.

Для всех тестов используются скрипты из `test_files/test_scripts`.
Все они в начале добавляют директорию `tmp_files` в путь для `import`,
после чего делают `import` оттуда `primes.so` и `help_functions.py`,
затем проверяют работу единственной функции модуля на нескольких заданных входах.

В `help_functions.py` реализована основная функция для тестов: `RunFactorOut`.
Она выводит в `tmp_files/real_output` информацию об аргументах,
передаваемых функции `factor_out` при тестировании,
корректности типа объекта, возвращаемого функцией `factor_out`,
и, собственно, сам возвращаемый объект.
Помимо аргументов, передаваемых функции `factor_out`,
функция `RunFactorOut` принимает флаги об ожидаемом результате:
является ли число простым и ожидается ли исключение,
в зависимости от этого отличается запуск и проверка результата функции `factor_out`.
Есть также флаг `last_run`, он используется, чтобы при последнем запуске
в файле с тестами не выводился лишний перенос строки.

Для уровня тестов `run.sh` используются скрипты из `test_files/test_scripts`:
- `test_basic.py`: проверяет работу на положительных числах `int32_t`,
гарантируется, что числа >= 2.
- `test_random.py`: проверяет то же самое, отличие от предыдущего теста в том,
что числа генерируюся рандомно.
`test_files/help_scripts/generate_random_numbers.py` генерирует их в `tmp_files/random_numbers.txt`.
`test_files/help_scripts/random_expected.py` получает ожидаемый вывод для этого теста
как `test_files/expected_output/TestSimple2Random.txt`.

Для уровня тестов `run_hard.sh` используются скрипты из `test_files/test_scripts`:
- `test_long_long.py`: проверяет работу на положительных числах `int64_t`,
гарантируется, что числа >= 2.
- `test_negative.py`: проверяет работу на отрицательных числах `int32_t`,
гарантируется, что числа по модулю >= 2,
гарантируется, что при домножении на -1 числа останутся в типе `int32_t`.
- `test_long_long_neg.py`: проверяет работу на отрицательных числах `int64_t`,
гарантируется, что числа по модулю >= 2,
гарантируется, что при домножении на -1 числа останутся в типе `int64_t`.
- `test_special_num.py`: проверяет случаи 1, -1, 0,
случаи чисел, больше типа `int64_t`,
а также случаи самых больших чисел типов `int32_t` и `int64_t`.
- `test_special_types.py`: проверяет обработку некорректных передаваемых типов
и некорректного числа аргументов.
